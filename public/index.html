<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ANURAG BOT PANEL</title>
<style>
  body { font-family: Arial, sans-serif; background: #f5f5f5; margin: 0; padding: 0; }
  header { background: #4CAF50; color: white; padding: 20px; text-align: center; font-size: 24px; }
  main { padding: 20px; max-width: 900px; margin: auto; }
  input, button { padding: 10px; margin: 5px 0; width: 100%; font-size: 16px; }
  #logs { background: #222; color: #0f0; height: 400px; overflow-y: scroll; padding: 10px; font-family: monospace; }
  .btn { cursor: pointer; background: #4CAF50; border: none; color: white; font-weight: bold; }
  .btn-stop { background: #f44336; }
</style>
</head>
<body>
<header>ANURAG BOT PANEL</header>
<main>
  <label>Admin UID:</label>
  <input type="text" id="admin" placeholder="Enter admin UID">
  
  <label>AppState JSON:</label>
  <textarea id="appstate" rows="5" placeholder='Paste appstate JSON here'></textarea>
  
  <button class="btn" id="startBtn">ðŸš€ Start Bot</button>
  <button class="btn btn-stop" id="stopBtn">ðŸ›‘ Stop Bot</button>
  
  <h3>Bot Logs:</h3>
  <div id="logs"></div>
</main>

<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script>
  const socket = io();

  const adminInput = document.getElementById("admin");
  const appstateInput = document.getElementById("appstate");
  const logsDiv = document.getElementById("logs");
  const startBtn = document.getElementById("startBtn");
  const stopBtn = document.getElementById("stopBtn");

  function appendLog(txt){ logsDiv.innerHTML += txt + "<br>"; logsDiv.scrollTop = logsDiv.scrollHeight; }

  startBtn.onclick = async () => {
    const admin = adminInput.value.trim();
    const appstate = appstateInput.value.trim();
    if(!admin || !appstate){ alert("Admin and AppState required"); return; }

    const res = await fetch("/start-bot", {
      method:"POST",
      headers: { "Content-Type":"application/json" },
      body: JSON.stringify({ admin, appstate })
    });
    const txt = await res.text();
    appendLog(txt);
    socket.emit("join", admin);
  };

  stopBtn.onclick = async () => {
    const admin = adminInput.value.trim();
    if(!admin){ alert("Admin required"); return; }
    const res = await fetch(`/stop-bot?uid=${admin}`);
    const txt = await res.text();
    appendLog(txt);
  };

  socket.on("botlog", txt => { appendLog(txt); });
</script>
</body>
</html>
