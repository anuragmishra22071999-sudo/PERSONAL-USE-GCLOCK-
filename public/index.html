<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ANURAG</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; color: #333; padding: 20px; }
    h1 { color: #1a73e8; }
    #log { height: 400px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; background: #fff; }
    #controls { margin-top: 10px; }
    input, button { padding: 8px; margin: 5px; }
  </style>
</head>
<body>
  <h1>ANURAG BOT PANEL</h1>
  <div id="controls">
    <input type="text" id="adminUID" placeholder="Admin UID">
    <textarea id="appstate" placeholder="Paste appstate JSON here" rows="4" cols="50"></textarea><br>
    <button onclick="startBot()">Start Bot</button>
    <button onclick="stopBot()">Stop Bot</button>
    <button onclick="getLogs()">Refresh Logs</button>
  </div>
  <div id="log"></div>

  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script>
    const logDiv = document.getElementById("log");
    const socket = io();

    function startBot() {
      const uid = document.getElementById("adminUID").value.trim();
      const appstate = document.getElementById("appstate").value.trim();
      if(!uid || !appstate) { alert("Admin UID and Appstate required"); return; }
      fetch("/start-bot", { method:"POST", headers:{ "Content-Type":"application/json" }, body: JSON.stringify({ admin: uid, appstate }) })
        .then(r=>r.text()).then(t=>alert(t));
      socket.emit("join", uid);
    }

    function stopBot() {
      const uid = document.getElementById("adminUID").value.trim();
      if(!uid) { alert("Admin UID required"); return; }
      fetch(`/stop-bot?uid=${uid}`).then(r=>r.text()).then(t=>alert(t));
    }

    function getLogs() {
      const uid = document.getElementById("adminUID").value.trim();
      if(!uid) { alert("Admin UID required"); return; }
      fetch(`/logs?uid=${uid}`).then(r=>r.text()).then(t=>logDiv.innerText=t);
    }

    socket.on("botlog", msg => {
      logDiv.innerText += msg + "\n";
      logDiv.scrollTop = logDiv.scrollHeight;
    });
  </script>
</body>
</html>
